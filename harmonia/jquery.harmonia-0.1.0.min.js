/* https://github.com/registerguard/jquery-harmonia */;(function($){var constants={NS:"harmonia",C:((typeof(console)!=="undefined")?true:false)},methods={init:function(opts){return this.each(function(){var $this=$(this),data=$this.data(constants.NS),options=$.extend({},settings.external,$.fn[constants.NS].defaults,opts);if(!data){var $hrefs=$this.find("> li > a"),$select=$("<select>",{"class":options.selectClass});$this.data(constants.NS,{hrefs:$hrefs,init:false,matched:false,options:options,target:$this,select:$select});data=$this.data(constants.NS);}if(!data.init){data.init=true;options.onInit.call($this);if($hrefs.length){$this.addClass(settings.internal.initClass);if(options.defaultOption){var $default=optionize.call($this,$("<a />"),options.defaultOption);if($default.length){$default.appendTo($select);}}$hrefs.each(function(){var $option=optionize.call($this,$(this));if($option.length){$option.appendTo($select);}});$select.change(function(){var $$=$(this);options.onChange.call($this,$$);var val=$$.val();if(val&&(val!=="#")){if(val!=options.defaultOption){(options.openTab)?window.open(val):window.location=val;}}}).insertBefore($this);options.onAfterInit.call($this);}else{if(constants.C){console.warn("there was a problem with your markup");}return this;}}else{if(constants.C){console.warn(constants.NS,"already initialized on",this);}return this;}});},destroy:function(){return this.each(function(){var $$=$(this),data=$$.data(constants.NS);if(data){var options=data.options;$$.removeClass(settings.internal.initClass);data.select.remove();$$.removeData(constants.NS);}else{if(constants.C){console.warn(constants.NS,"already initialized on",this);}}});}},optionize=function($a,text){var $return="",data=this.data(constants.NS);if(data){text=((typeof text!=="undefined")&&text.length)?text:textualize.call($a);if(text.length){var $option=$("<option />"),selected=false,uri=($a.attr("href")||"");if(!data.matched){if($a.attr("class")=="selected"){selected=true;}else{if(data.options.currentPage){if(uri!="#"){var href=$(location).attr("href");if((uri==href)||(href.indexOf(uri)>0)){selected=true;}}}}if(selected){$option.attr("selected","selected");data.matched=true;}}$option.attr("value",uri);$return=$option.text($.trim(text));}else{if(constants.C){console.warn("there's no text for",this);}}}data.options.onAddOption.call(this,$return);return $return;},textualize=function(){return(this.length)?this.clone().children().remove().end().text():"";};$.fn[constants.NS]=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1));}else{if((typeof method==="object")||(!method)){return methods.init.apply(this,arguments);}else{$.error("Method "+method+" does not exist on jQuery."+constants.NS);}}};var settings={};settings.internal={initClass:constants.NS+"-js-enabled"};settings.external={currentPage:false,defaultOption:"Choose...",openTab:false,selectClass:constants.NS+"-select",selectId:false,onInit:function(){},onAfterInit:function(){},onAddOption:function(){},onChange:function(){}};$.fn[constants.NS].defaults=settings.external;})(jQuery);